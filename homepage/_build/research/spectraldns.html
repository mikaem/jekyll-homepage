---
interact_link: content/research/spectraldns.ipynb
kernel_name: python3
has_widgets: false
title: |-
  SpectralDNS
prev_page:
  url: /cv.html
  title: |-
    CV
next_page:
  url: /research/biomedical.html
  title: |-
    Biomedical Flows
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="SpectralDNS">SpectralDNS<a class="anchor-link" href="#SpectralDNS"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell tag_popout">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<!-- img src="../images/KHmovie2.gif" width="250"  -->

<p><img src="https://raw.githack.com/spectralDNS/spectralutilities/master/movies/RB_200k_Warp.gif" width="300" /></p>
<p>Rayleigh-BÃ©nard convection computed with spectral accuracy using a <a href="https://github.com/spectralDNS/spectralDNS/blob/master/demo/RayleighBenard.py">spectralDNS solver</a>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://github.com/spectralDNS">spectralDNS</a> project revolves around
implementing high-performance flow solvers in <a href="https://www.python.org">Python</a>, which is a modern and very
high-level programming language. The project is supported through several grants from <a href="https://www.hpc.kaust.edu.sa">King
Abdullahs University of Science and Technology</a>,
granting access to some of the world's largest supercomputers. The work has
been presented at several conferences and as invited talks</p>
<ul>
<li><p><a href="http://tianyuan.xmu.edu.cn/activities/19-20/ICSCA2019/index.html">11'th International Conference on Scientific Computing and Applications</a></p>
</li>
<li><p><a href="https://cseconf2017.simula.no">International Conference on Computational Science and Engineering</a></p>
</li>
<li><p><a href="https://www.aices.rwth-aachen.de/en/media-and-seminars/events/mortensen-seminar">I3MS Seminar Series of the Institute for Modeling and Simulation, 6 Nov 2017 RWTH AAchen University</a></p>
</li>
<li><p><a href="https://pccfd.kaust.edu.sa/speaker?si=4">Predictive Complex Computational Fluid Dynamics, KAUST, May 2017</a></p>
</li>
<li><p><a href="http://arxiv.org/abs/1708.03188">MekIT'17 National Conference on computational Mechanics, Trondheim, May 2017</a></p>
</li>
<li><p><a href="https://www.euroscipy.org/2015/schedule/presentation/6/">EuroScipy, Cambridge, August 2015</a></p>
</li>
</ul>
<p>The <em>spectralDNS</em> project on github contains several repositories, each representing a smaller part of the overall project. The most important are presented beolw.</p>
<h2 id="spectralDNS">spectralDNS<a class="anchor-link" href="#spectralDNS"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell tag_popout">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.githack.com/spectralDNS/spectralutilities/master/figures/strong_scaling_pencil_col.png" width="300"/></p>
<p>Strong scaling of triply periodic Navier-Stokes solver on the Shaheen II supercomputer at KAUST.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="https://github.com/spectralDNS/spectralDNS">spectralDNS</a> repository is home to several different pseudo-spectral Navier-Stokes and MagnetoHydroDynamics solvers. Most solvers are for triply periodic domains. The simplest possible Navier-Stokes solver is described by {% cite Mortensen2016 %}, who show that a highly efficient solver can be created using no more than 100 lines of code, using nothing more than standard
tools like <em>Numpy</em> and <em>MPI for Python</em>. The DNS solver has been tested for a
transitional Taylor-Green vortex using a computational box of size $2048^3$. Accuracy is, well spectral, and in benchmark tests on the Shaheen II supercomputer at KAUST it has been found to scale well up to 64,000 cores.
A state-of-the-art spectral channel flow solver that is making extensive use of <em>shenfun</em>, has been described by {% cite mortensen2017spectral %}. Turbulent flow at $Re_{\tau}=2000$ is shown in the movie below.</p>
<p><img src="https://raw.githack.com/spectralDNS/spectralutilities/master/movies/Re2000_cropped.gif" width="600" /></p>
<h2 id="Shenfun">Shenfun<a class="anchor-link" href="#Shenfun"> </a></h2><p>With the <a href="https://github.com/spectralDNS/shenfun">shenfun</a> Python module
{% cite shenfun %} an
effort is made towards automating the implementation of the spectral Galerkin
method for simple tensor product domains, consisting of non-periodic and
periodic directions. The user interface to <em>shenfun</em> is intentionally made very
similar to <a href="https://fenicsproject.org">FEniCS</a>. Partial Differential Equations
are represented through weak variational forms and solved using efficient direct
solvers where available. MPI decomposition is achieved through the 
<a href="https://bitbucket.org/mpi4py/mpi4py-fft">mpi4py-fft</a> module, and all developed solvers may,
with no additional effort, be run on supercomputers using thousands of
processors.</p>
<p>An introduction to <em>shenfun</em> is given in {% cite shenfun %}, on <a href="https://shenfun.readthedocs.io">readthedocs</a>
and the recent paper {% cite mortensen_joss %}. Introduction to <em>mpi4py-fft</em>
is given <a href="https://mpi4py-fft.readthedocs.io/en/latest/">here</a> and
in {% cite mpi4py-fft_joss %} {% cite jpdc_fft %}. Further documentation is found at</p>
<p><a href="https://shenfun.readthedocs.io/en/latest/"><img src="https://readthedocs.org/projects/shenfun/badge/?version=latest" alt="Documentation"></a></p>
<p>Try shenfun in the computational cell below. Modify to own liking and run interactively.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">shenfun</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x,y&quot;</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;Chebyshev&#39;</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;Fourier&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TensorProductSpace</span><span class="p">(</span><span class="n">comm</span><span class="p">,</span> <span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">F</span><span class="p">))</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="n">T</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">local_mesh</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="o">.</span><span class="n">backward</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/research/spectraldns_5_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="mpi4py-fft">mpi4py-fft<a class="anchor-link" href="#mpi4py-fft"> </a></h2><p>mpi4py-fft is a Python package for computing Fast Fourier Transforms (FFTs).
Large arrays are distributed and communications are handled under the hood by
MPI for Python (mpi4py). To distribute large arrays we are using a
<a href="https://arxiv.org/abs/1804.09536">new and completely generic algorithm</a>
that allows for any index set of a multidimensional array to be distributed. We
can distribute just one index (a slab decomposition), two index sets (pencil
decomposition) or even more for higher-dimensional arrays.</p>
<p>mpi4py-fft comes with its own Python interface to the serial
<a href="http://www.fftw.org">FFTW</a> library. This interface can be used
much like <a href="https://hgomersall.github.io/pyFFTW">pyfftw</a>, and even for
real-to-real transforms, like discrete cosine or sine transforms. Further documentation is found at</p>
<p><a href="https://mpi4py-fft.readthedocs.io/en/latest/"><img src="https://readthedocs.org/projects/mpi4py-fft/badge/?version=latest" alt="Documentation"></a></p>
<p>Number of downloads from conda-forge:</p>
<p><a href="https://anaconda.org/conda-forge/mpi4py-fft"><img src="https://anaconda.org/conda-forge/mpi4py-fft/badges/downloads.svg" alt="Anaconda-Server Badge"></a></p>
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><p>{% bibliography --cited %}</p>

</div>
</div>
</div>
</div>

 

